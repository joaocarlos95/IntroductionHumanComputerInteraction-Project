<!DOCTYPE html>
<html>
<head>
	<title>BarISTa</title>

	<link rel="stylesheet" href="Website.css">
	<style type="text/css"> </style>

	<script type="text/javascript">
		
		var info = 0;

		function Information() {
	    	if (info == 0) {
		        var overlay = document.getElementById("OverlayInformation");
		        var popup = document.getElementById("PopupInformation");
		        overlay.style.display = "block";
		        popup.style.display = "block";     		        
		        info = 1;
		    }
		    else {
	        	var overlay = document.getElementById("OverlayInformation");
	        	var popup = document.getElementById("PopupInformation");
	        	overlay.style.display = "none";
	        	popup.style.display = "none";
	        	info = 0; 
			}
    	}
    	function CarregaPagina(ref) {
			var lista = sessionStorage.getItem("lista").split(",");
			if (ref == "Voltar") {
				lista.splice(lista.length-1, 1);
				var x = lista.length-1;
				location.href = lista[x];
			}
			else if (ref == "AdicionarMusica") {
				lista.push("MenuAdicionarMusica.html");
				location.href = "MenuAdicionarMusica.html";
			}
			else if (ref == 'Bebida') {
				lista = [lista[0]]
				lista.push("MenuEmenta.html")
	    		lista.push("MenuBebida.html");
	    		location.href = 'MenuBebida.html';
			}
			else if (ref == 'Comida') {
				lista = [lista[0]]
				lista.push("MenuEmenta.html")
	    		lista.push("MenuComida.html");
	    		location.href = 'MenuComida.html';
			}
			else if (ref == 'Escrever') {
				lista = [lista[0]]
				lista.push("MenuSugestoes.html")
	    		lista.push("MenuInserirComentario.html");
	    		location.href = 'MenuInserirComentario.html';
			}
			else if (ref == 'Ler') {
				lista = [lista[0]]
				lista.push("MenuSugestoes.html")
	    		lista.push("MenuVerComentarios.html");
	    		location.href = 'MenuVerComentarios.html';
			}
			else if (ref == 'Geral') {
				lista = [lista[0]]
				lista.push("MenuMusica.html")
	    		lista.push("MenuGeral.html");
	    		location.href = 'MenuGeral.html';
			}
			else if (ref == 'Home') {
				lista = [lista[0]]
	    		location.href = lista[0];
			}
			sessionStorage.setItem("lista", lista);
	  	}
 	
	</script>
	
</head>


<body style="font-family:sans-serif; text-align: center; margin: 0%">
	<div id="mySidenav" class="sidenav">
		<div style="position: absolute; top: 0%; left: 37%"><h4> Ol&aacute; Hugo! </h4></div>
	 	<a style="position: absolute; right: 5%; top: 1%" class="closebtn menu_home" onclick="closeNav()">&times;</a>
	 	<table style="margin-top: 10%;">
		  	<tr>
			  	<td><div style="transform: rotate(-90deg); margin-left:-40%">Ementa</div></td>
		  		<td><img style="margin-left:-80%; margin-top:10%; cursor:pointer;" src="Comida.png" width="115%" onclick="CarregaPagina('Comida')" class="menu_home"></img></td>
				<td><img style="margin-left:-40%; margin-top:10%; cursor:pointer;" src="Bebida.png" width="115%" onclick="CarregaPagina('Bebida')" class="menu_home"></img></td>
			</tr>
		  	<tr><td colspan="3" style="border-top: 2px solid #001c2a; padding-bottom: 2%"></td></tr>
		  	<tr><td colspan="3" style="visibility: hidden; padding-bottom: 10%"></td></tr>
		  	<tr>
			  	<td><div style="transform: rotate(-90deg); margin-left:-40%">M&uacute;sica</div></td>
		  		<td><img style="margin-left:-80%; margin-top:10%; opacity: 0.5;" src="Pessoal.png" width="115%"></img></td>
				<td><img style="margin-left:-40%; margin-top:10%; cursor:pointer;" src="Geral.png" width="115%" onclick="CarregaPagina('Geral')" class="menu_home"></img></td>
			</tr>
			<tr><td colspan="3" style="border-top: 2px solid #001c2a; padding-bottom: 2%"></td></tr>
		  	<tr><td colspan="3" style="visibility: hidden; padding-bottom: 10%"></td></tr>
			<tr>
			  	<td><div style="transform: rotate(-90deg); margin-left:-40%">Sugest&otilde;es</div></td>
		  		<td><img style="margin-left:-80%; margin-top:10%; cursor:pointer" src="Escrever.png" width="115%" onclick="CarregaPagina('Escrever')" class="menu_home"></img></td>
				<td><img style="margin-left:-40%; margin-top:10%; cursor:pointer" src="Ler.png" width="115%" onclick="CarregaPagina('Ler')" class="menu_home"></img></td>
			</tr>
			<tr><td colspan="3" style="border-top: 2px solid #001c2a; padding-bottom: 2%"></td></tr>
			<tr class="menu_home">
				<td> <img style="padding-top:20%; margin-left:60%; cursor:pointer;" src="HomeButton.png" width="60%" onclick="CarregaPagina('Home')"> </img></td>
				<td style="padding-top:8%; font-size:145%; padding-left:10%; color:#E6E6E6; cursor:pointer;" onclick="CarregaPagina('Home')"> HOME </td>
			</tr>
		</table>
	</div>
	<div id="main">
		<div><img style="position:fixed; opacity:0.20;" src="PessoalIcon.png" width="50%" height="100%"></img></div>
		<div style="padding-top: 8.5%"><h1> Lista Pessoal </h1></div>
		<div><img onclick="Information()" class="InfoButton menu_home" src="HelpButton.png" style="cursor: pointer;"></img></div>
		<div id="OverlayInformation2"></div>
		<div id="OverlayInformation1" onclick="closeNav()"></div>
		<div id="OverlayInformation" onclick="Information()"></div>
		<div style="margin: 0 auto; height: 40%" id="PopupInformation">
		   	<h2 style="padding-top: 2%"> Lista Pessoal </h2>
			<h4> Neste menu encontra-se a lista pessoal das suas m&uacute;sicas neste bar.</h4>
			<ul style="text-align: left; padding-right: 5%; padding-left: 7.5%">
				<li> Para adicionar uma nova m&uacute;sica a partir do seu dispositivo, s&oacute; tem que carregar no bot&atilde;o "Adicionar" no canto inferior esquerdo. </li>
				<li> Para adicionar uma m&uacute;sica da sua lista &agrave; Lista Geral carregue no bot&atilde;o "+ Geral", situado na primeira coluna da tabela. Se n&atilde;o tiver o bot&atilde;o na m&uacute;sica pretendida &eacute; porque a m&uacute;sica j&aacute; se encontra na Lista Geral.</li>
				<li> Para remover m&uacute;sicas da sua lista carregue no bot&atilde;o "Remover" da respectiva m&uacute;sica, situado na &uacute;ltima coluna da tabela. </li>
			</ul>
			<div><img onclick="Information()" class="CloseButton menu_home" src="CloseIcon.png" style="cursor: pointer;"></img></div>
		</div>
		<div style="margin: 0 auto; height: 33%;" id="PopupInformation1">
			<h2 style="padding-top: 2%"> Adicionar M&uacute;sica &agrave; Lista Geral </h2>
			<h4> Pretende adicionar a m&uacute;sica &agrave; lista do bar? </h4>
			<div id="AdicionarMusicaGeral" style="text-align: center"></div>
			<div><img onclick="Information()" id="CloseButton1" class="CloseButton" src="CloseIcon.png" style="cursor: pointer;"></img></div>
			<div onclick="AdicionarGeral('Nao')"><h3 style="left:33%; cursor:pointer; bottom:1%" id="OkNao" class="BotaoOknOk menu_home"> N&atilde;o </h3></div>
			<div onclick="AdicionarGeral('Sim')"><h3 style="right:33%; cursor:pointer; bottom:1%" id="OkSim" class="BotaoOknOk menu_home"> Sim </h3></div>
		</div>
		<div style="margin: 0 auto; height: 33%" id="PopupInformation2">
			<h2 style="padding-top: 2%"> Remover M&uacute;sica da Lista Pessoal </h2>
			<h4> Tem a certeza que pretende remover a m&uacute;sica da sua lista? </h4>
			<div id="RemoverMusicaPessoal" style="text-align: center"></div>
			<div onclick="RemoverPessoal('Nao')"><h3 style="left:33%; cursor:pointer; bottom:1%" id="OkNao1" class="BotaoOknOk menu_home"> N&atilde;o </h3></div>
			<div onclick="RemoverPessoal('Sim')"><h3 style="right:33%; cursor:pointer; bottom:1%" id="OkSim1" class="BotaoOknOk menu_home"> Sim </h3></div>
		</div>
		
		<div onclick="CarregaPagina('Voltar')" class="BotaoVoltar menu_home" style="cursor: pointer;"><h2> Voltar </h2></div>
		<div onclick="CarregaPagina('AdicionarMusica')" class="BotaoNovo menu_home" style="cursor: pointer;"><h2> Carregar </h2></div>
		<div class="qwerty"> <h4 style="margin-top: 1.3%"> </h4> </div>
		<div class="qwerty">
			<h4 style="margin-top: 1.3%"> </h4>
			<img style="position: absolute; top:1%; left:95.35%; cursor: pointer;" src="Musica.png" width="4.75%" onclick="CarregaPagina('Voltar')" class="menu_home">
		</div>

		<div style="position:absolute; left:3%; top:30%; width:90%; border-top:5px solid grey;">
			<div class="tabelaProdutos" style="padding-top: 2%" id="users">
	  			<div> <input class="search" placeholder=" Procurar" style="font-size:150%; width:50%; border:0.2px solid grey"/> </div>
				<center>
					<table style="width: 79%; position: absolute; top: 125%; left: 10.04%;">
						<thead style="font-size: 80%">
							<tr>
								<th width="10%"></th>
								<th width="26.7%"> Nome </th>
								<th width="26.7%" colspan="2"> Alb&uacute;m</th>
								<th width="26.6%"> Artista </th>
								<th width="10%"></th>
							</tr>
						</thead>
					</table> 
				<div style="width: 80%; position: absolute; top: 215%; left: 10%; " class="tabelaComentario3">
		  			<table class="list1">
						<tbody class="list" style="font-size:65%">
							<tr class="tabelaColuna" id="aaa">
								<td width="10%" class="geral"> <img class="image menu_home" width="90%" height="8%" src="MusicaGeral.png"></td>
								<td width="26.6%" class="nome"></td>
								<td width="5%" class="albumImage1"> <img class="albumImage" src="Hamburguer.png" width="93%"> </td>
								<td width="21.7%" class="album"></td>
								<td width="26.6%" class="artista"></td>
								<td width="10%" class="BotaoRemover"> <div style="border:2px solid grey; background-color:white; color:black; border-radius:5%; text-align: center; cursor: pointer;" class="BotaoRemover1" class="menu_home"> Remover </div> </td>
							</tr>
						</tbody>
					</table>
				</div> </center>
			</div>	
		</div>
		</div>
		<span style="position:absolute; top: 1%; left: 2%; font-size:450%; cursor:pointer; color:#3F3E3E;" onclick="openNav()" class="menu_home">&equiv;</span>
	</div>
	<script>
		function openNav() {
		    document.getElementById("mySidenav").style.width = "22%";
		    setTimeout(function() {
		    document.getElementById("OverlayInformation1").style.display = "block";
   		    document.getElementById("OverlayInformation1").style.left = "22%";
		    }, 650);
		}

		function closeNav() {
		    document.getElementById("mySidenav").style.width = "0%";
		    document.getElementById("OverlayInformation1").style.display = "none";
   		    document.getElementById("OverlayInformation1").style.left = "0%";
		}
	</script>
	<script src="jquery.min.js"></script>
	<script src="list.min.js"></script>
	<script src="list.pagination.min.js"></script>
	<script type="text/javascript">

		nomeGeral = null
		albumGeral = null
		artistaGeral = null
		albumImagemGeral = null
		nomeRemover = null
		albumRemover = null
		artistaRemover = null

		var listaPessoal  = JSON.parse(sessionStorage.getItem("listaPessoal"));	
		var options = {valueNames: ['nome', 'album', 'artista', {attr:'src', name:'image'}, {attr:'src', name:'albumImage'}]};
		var userList = new List('users', options);
		var i = 0;
		for (i=0; i < listaPessoal.length; i++) {
			userList.add({ nome:listaPessoal[i].nome, album:listaPessoal[i].album, artista:listaPessoal[i].artista, image:listaPessoal[i].botao, albumImage:listaPessoal[i].albumImagem});
		}

		userList.sort('nome', { order: "asc" });
		document.getElementById("aaa").style.display = "none"

		$('.BotaoRemover1').click(function() {
    		nomeRemover = $(this).parent().siblings(".nome").html();
    		albumRemover = $(this).parent().siblings(".album").html();
    		artistaRemover = $(this).parent().siblings(".artista").html();

    		document.getElementById("CloseButton1").style.display = "none";
			document.getElementById("OkNao1").style.display = "block";
			document.getElementById("OkSim1").style.display = "block";
			$("#RemoverMusicaPessoal").html(nomeRemover + " - " + artistaRemover)
			var overlay = document.getElementById("OverlayInformation2");
			var popup = document.getElementById("PopupInformation2");
			overlay.style.display = "block";
			popup.style.display = "block";
		});

		function AdicionarGeral(ref) {
    		if (ref == "Sim") {
    			var variavelGeral = sessionStorage.getItem("variavelGeral")
		  		variavelGeral = parseInt(variavelGeral)
		  		sessionStorage.setItem("variavelGeral", variavelGeral++)
		  		variavelGeral = {nome:nomeGeral, album:albumGeral, artista:artistaGeral, gostos:1, botao:"LikeButtonCheck.png", albumImagem: albumImagemGeral};
				
				var listaGeral  = JSON.parse(sessionStorage.getItem("listaGeral"));
				listaGeral.push(variavelGeral)
				listaGeral = listaGeral.sort(listaSort('gostos'));
				sessionStorage.setItem("listaGeral",JSON.stringify(listaGeral));
				
				for (i=0; i < listaPessoal.length; i++) {
					if (listaPessoal[i].nome == nomeGeral) {
						if (listaPessoal[i].album == albumGeral) {
							if (listaPessoal[i].artista == artistaGeral) {
								listaPessoal[i].botao = "MusicaGeralHidden.png"
								listaPessoal[i].gostos = 1;
								sessionStorage.setItem("listaPessoal",JSON.stringify(listaPessoal));
							} 
						}
					}
				}
				location.reload()
    		}
    		else {
				document.getElementById("OkNao").style.display = "none";
				document.getElementById("OkSim").style.display = "none";
				var overlay = document.getElementById("OverlayInformation2");
				var popup = document.getElementById("PopupInformation1");
				overlay.style.display = "none";
				popup.style.display = "none";
    		}
    	}

    	function RemoverPessoal(ref) {
    		if (ref == "Sim") {
				for (i=0; i < listaPessoal.length; i++) {
					if (listaPessoal[i].nome == nomeRemover) {
						if (listaPessoal[i].album == albumRemover) {
							if (listaPessoal[i].artista == artistaRemover) {
								listaPessoal.splice(i, 1);
								sessionStorage.setItem("listaPessoal",JSON.stringify(listaPessoal));
							} 
						}
					}
				}
				location.reload()
    		}
    		else {
				document.getElementById("OkNao1").style.display = "none";
				document.getElementById("OkSim1").style.display = "none";
				var overlay = document.getElementById("OverlayInformation2");
				var popup = document.getElementById("PopupInformation2");
				overlay.style.display = "none";
				popup.style.display = "none";
    		}
    	}
		
		$('.image').click(function() {
			function listaSort(ref) {
				return function(var1, var2) {
					return (var1[ref] > var2[ref]) ? -1:(var1[ref] < var2[ref] ? 1:0);
				}
			}				

			if ($(this).attr('src') == "MusicaGeral.png") {
				nomeGeral = $(this).parent().siblings(".nome").html();
	    		albumGeral = $(this).parent().siblings(".album").html();
	    		artistaGeral = $(this).parent().siblings(".artista").html();
	    		albumImagemGeral = $(this).parent().siblings(".albumImage1").children().attr('src');
	    		console.log(albumImagemGeral);
						
				document.getElementById("CloseButton1").style.display = "none";
				document.getElementById("OkNao").style.display = "block";
				document.getElementById("OkSim").style.display = "block";
				$("#AdicionarMusicaGeral").html(nomeGeral + " - " + artistaGeral)
				var overlay = document.getElementById("OverlayInformation2");
				var popup = document.getElementById("PopupInformation1");
				overlay.style.display = "block";
				popup.style.display = "block";
			}
		});
	</script>
	<script src="jquery.min.js"></script>
	<script type="text/javascript">
		
  		var listaGeral = JSON.parse(sessionStorage.getItem("listaGeral"));
		if (listaGeral[0].gostos == 0) {
			$(".qwerty").children().html(listaGeral[0].nome + " - " + listaGeral[0].album + " - " + listaGeral[0].artista)
		}
		else {
			listaGeral.sort(listaSort('gostos'));
			$(".qwerty").children().html(listaGeral[0].nome + " - " + listaGeral[0].album + " - " + listaGeral[0].artista)
		}
		sessionStorage.setItem("listaGeral",JSON.stringify(listaGeral));

		function listaSort(ref) {
			return function(var1, var2) {
				return (var1[ref] > var2[ref]) ? -1:(var1[ref] < var2[ref] ? 1:0);
			}
		}

		setInterval(function() {
			listaGeral = JSON.parse(sessionStorage.getItem("listaGeral"));
			listaGeral[0].gostos = 0;
			listaGeral[0].botao = "LikeButtonUncheck.png";
			listaGeral.push(listaGeral[0]);
			listaGeral.shift();
			sessionStorage.setItem("listaGeral",JSON.stringify(listaGeral));
			if (listaGeral[0].gostos == 0) {
				$(".qwerty").children().html(listaGeral[0].nome + " - " + listaGeral[0].album + " - " + listaGeral[0].artista)
			}
			else {
				listaGeral.sort(listaSort('gostos'));
				$(".qwerty").children().html(listaGeral[0].nome + " - " + listaGeral[0].album + " - " + listaGeral[0].artista)
			}
			sessionStorage.setItem("listaGeral",JSON.stringify(listaGeral));

			function listaSort(ref) {
				return function(var1, var2) {
					return (var1[ref] > var2[ref]) ? -1:(var1[ref] < var2[ref] ? 1:0);
				}
			}
		}, 5000);
	</script>
</body>
</html>